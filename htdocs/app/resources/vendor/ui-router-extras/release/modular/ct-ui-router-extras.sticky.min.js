/** UI-Router Extras v.0.0.13 Module: sticky http://christopherthielen.github.io/ui-router-extras/ - MIT License */
!function(e,t){"use strict";function n(t,n){var a=n,r=a.inheritParams,s=a.protoKeys,o=a.map,i={},l={},c=!1;this.registerStickyState=function(e){l[e.name]=e},this.enableDebug=this.debugMode=function(t){return e.isDefined(t)&&(c=t),c},this.$get=["$rootScope","$state","$stateParams","$injector","$log",function(t,n,a,l,f){function v(){var t={};return e.forEach(i,function(e){for(var n=d(e),a=0;a<n.length;a++){var r=n[a].parent;t[r.name]=t[r.name]||[],t[r.name].push(e)}t[""]&&(t.__inactives=t[""])}),t}function d(e){var t=[];if(!e)return t;do e.sticky&&t.push(e),e=e.parent;while(e);return t.reverse(),t}function m(e,t,n){if(e[n]===t[n])return{from:!1,to:!1};var a=n<e.length&&e[n].self.sticky,r=n<t.length&&t[n].self.sticky;return{from:a,to:r}}function h(e,t,n,a){if(a)return"updateStateParams";var r=i[e.self.name];if(!r)return"enter";if(e.self===n)return"updateStateParams";var s=g(t,r.locals.globals.$stateParams,e.ownParams);return s?"reactivate":"updateStateParams"}function p(e,t){var n=i[e.name];if(!n)return null;if(!t)return n;var a=g(t,n.locals.globals.$stateParams,e.ownParams);return a?n:null}function g(t,n,a){if(!e.isArray(a)&&e.isObject(a)&&(a=s(a,["$$keys","$$values","$$equals","$$validates","$$new","$$parent"])),!a){a=[];for(var r in t)a.push(r)}for(var o=0;o<a.length;o++){var i=a[o];if(t[i]!=n[i])return!1}return!0}var $={getInactiveStates:function(){var t=[];return e.forEach(i,function(e){t.push(e)}),t},getInactiveStatesByParent:function(){return v()},processTransition:function(t){var s={inactives:[],enter:[],exit:[],keep:0},i=t.fromState.path,u=t.fromParams,l=t.toState.path,c=t.toParams,f=t.reloadStateTree,d=t.options,p=0,$=l[p];for(d.inherit&&(c=r(a,c||{},n.$current,t.toState));$&&$===i[p]&&g(c,u,$.ownParams);)$=l[++p];s.keep=p;var x,P,S,E={},b=m(i,l,p),k=!!d.reload;for(x=p;x<l.length;x++){var y=b.to?h(l[x],c,f,k):"enter";k=k||"updateStateParams"==y,s.enter[x]=y,"reactivate"==y&&(S=E[l[x].name]=l[x]),"updateStateParams"==y&&(P=E[l[x].name]=l[x])}S=S?S.self.name+".":"",P=P?P.self.name+".":"";var w=v(),F=[""].concat(o(i.slice(0,p),function(e){return e.self.name}));for(e.forEach(F,function(e){for(var t=w[e],n=0;t&&n<t.length;n++){var a=t[n];E[a.name]||S&&0===a.self.name.indexOf(S)||P&&0===a.self.name.indexOf(P)||s.inactives.push(a)}}),x=p;x<i.length;x++){var R="exit";b.from&&(s.inactives.push(i[x]),R="inactivate"),s.exit[x]=R}return s},stateInactivated:function(e){i[e.self.name]=e,e.self.status="inactive",e.self.onInactivate&&l.invoke(e.self.onInactivate,e.self,e.locals.globals)},stateReactivated:function(e){i[e.self.name]&&delete i[e.self.name],e.self.status="entered",e.self.onReactivate&&l.invoke(e.self.onReactivate,e.self,e.locals.globals)},stateExiting:function(t,n,a){var r={};e.forEach(n,function(e){r[e.self.name]=!0}),e.forEach(i,function(n,a){!r[a]&&n.includes[t.name]&&(c&&f.debug("Exiting "+a+" because it's a substate of "+t.name+" and wasn't found in ",r),n.self.onExit&&l.invoke(n.self.onExit,n.self,n.locals.globals),e.forEach(n.locals,function(e,t){delete u.locals[t]}),n.locals=null,n.self.status="exited",delete i[a])}),a&&l.invoke(a,t.self,t.locals.globals),t.locals=null,t.self.status="exited",delete i[t.self.name]},stateEntering:function(e,t,n,a){var r=p(e);if(r&&(a||!p(e,t))){var s=e.locals;this.stateExiting(r),e.locals=s}e.self.status="entered",n&&l.invoke(n,e.self,e.locals.globals)},reset:function(e,a){var r=n.get(e),s=p(r,a);return s?($.stateExiting(s),t.$broadcast("$viewContentLoading"),!0):!1}};return $}]}function a(e){return{resolve:{},locals:{globals:o&&o.locals&&o.locals.globals},views:{},self:{},params:{},ownParams:c.hasParamSet?{$$equals:function(){return!0}}:[],surrogateType:e}}e.module("ct.ui.router.extras.sticky",["ct.ui.router.extras.core"]);var r=e.module("ct.ui.router.extras.sticky");n.$inject=["$stateProvider","uirextras_coreProvider"],r.provider("$stickyState",n);var s,o,i,u,l=[],c={hasParamSet:!1};e.module("ct.ui.router.extras.sticky").run(["$stickyState",function(e){s=e}]),e.module("ct.ui.router.extras.sticky").config(["$provide","$stateProvider","$stickyStateProvider","$urlMatcherFactoryProvider","uirextras_coreProvider",function(n,r,f,v,d){function m(t,n,a){function r(e,t,n){return e[t]?e[t].toUpperCase()+": "+n.self.name:"("+n.self.name+")"}var o=x(a.inactives,function(e){return e.self.name}),i=x(n.toState.path,function(e,t){return r(a.enter,t,e)}),u=x(n.fromState.path,function(e,t){return r(a.exit,t,e)}),l=n.fromState.self.name+": "+e.toJson(n.fromParams)+":  -> "+n.toState.self.name+": "+e.toJson(n.toParams);t.debug("   Current transition: ",l),t.debug("Before transition, inactives are:   : ",x(s.getInactiveStates(),function(e){return e.self.name})),t.debug("After transition,  inactives will be: ",o),t.debug("Transition will exit:  ",u),t.debug("Transition will enter: ",i)}function h(e,t,n){e.debug("Current state: "+t.self.name+", inactive states: ",x(s.getInactiveStates(),function(e){return e.self.name}));for(var a=function(e,t){return"'"+t+"' ("+e.$$state.name+")"},r=function(e,t){return"globals"!=t&&"resolve"!=t},o=function(e){var t=x(P(e.locals,r),a).join(", ");return"("+(e.self.name?e.self.name:"root")+".locals"+(t.length?": "+t:"")+")"},i=o(t),u=t.parent;u&&u!==t;)""===u.self.name&&(i=o(n.$current.path[0])+" / "+i),i=o(u)+" / "+i,t=u,u=t.parent;e.debug("Views: "+i)}var p=d,g=p.internalStates,$=p.inherit,x=(p.inheritParams,p.map),P=p.filterObj;c.hasParamSet=!!v.ParamSet,u=e.extend(new a("__inactives"),{self:{name:"__inactives"}}),o=i=t,l=[],d.onStateRegistered(function(e){e.self.sticky===!0&&f.registerStickyState(e.self)});var S;n.decorator("$state",["$delegate","$log","$q",function(n,r,d){return o=n.$current,g[""]=o,o.parent=u,u.parent=t,o.locals=$(u.locals,o.locals),delete u.locals.globals,S=n.transitionTo,n.transitionTo=function(t,p,$){function P(t){var n=e.extend(new a("reactivate_phase1"),{locals:t.locals});return n.self=e.extend({},t.self),n}function E(t){var n=e.extend(new a("reactivate_phase2"),t),r=n.self.onEnter;return n.resolve={},n.views={},n.self.onEnter=function(){n.locals=t.locals,s.stateReactivated(t)},J.addRestoreFunction(function(){t.self.onEnter=r}),n}function b(e){var t=new a("inactivate");t.self=e.self;var n=e.self.onExit;return t.self.onExit=function(){s.stateInactivated(e)},J.addRestoreFunction(function(){e.self.onExit=n}),t}function k(e,t){var n=e.self.onEnter;return e.self.onEnter=function(){s.stateEntering(e,t,n)},J.addRestoreFunction(function(){e.self.onEnter=n}),e}function y(e,t){var n=e.self.onEnter;return e.self.onEnter=function(){s.stateEntering(e,t,n,!0)},J.addRestoreFunction(function(){e.self.onEnter=n}),e}function w(e){var t=e.self.onExit;return e.self.onExit=function(){s.stateExiting(e,B,t)},J.addRestoreFunction(function(){e.self.onExit=t}),e}var F=f.debugMode();u.locals||(u.locals=o.locals);var R=l.length;i&&(i(),F&&r.debug("Restored paths from pending transition"));var T,_,I,O,j=n.$current,C=n.params,M=$&&$.relative||n.$current,q=n.get(t,M),A=[],B=[];p=p||{},arguments[1]=p;var D=function(){},J=function(){T&&(K.path=T,T=null),_&&(j.path=_,_=null),e.forEach(J.restoreFunctions,function(e){e()}),J=D,i=null,l.splice(R,1)};if(J.restoreFunctions=[],J.addRestoreFunction=function(e){this.restoreFunctions.push(e)},q){var K=g[q.name];if(K){T=K.path,_=j.path;var L=$&&$.reload||!1,U=L&&(L===!0?T[0].self:n.get(L,M));$&&L&&L!==!0&&delete $.reload;var V={toState:K,toParams:p||{},fromState:j,fromParams:C||{},options:$,reloadStateTree:U};if(l.push(V),i=J,U){V.toParams.$$uirouterextrasreload=Math.random();var z=U.$$state().params,G=U.$$state().ownParams;if(c.hasParamSet){var H=new v.Param("$$uirouterextrasreload");z.$$uirouterextrasreload=G.$$uirouterextrasreload=H,J.restoreFunctions.push(function(){delete z.$$uirouterextrasreload,delete G.$$uirouterextrasreload})}else z.push("$$uirouterextrasreload"),G.push("$$uirouterextrasreload"),J.restoreFunctions.push(function(){z.length=z.length-1,G.length=G.length-1})}I=s.processTransition(V),F&&m(r,V,I);var N=K.path.slice(0,I.keep),Q=j.path.slice(0,I.keep);e.forEach(u.locals,function(e,t){-1!=t.indexOf("@")&&delete u.locals[t]});for(var W=0;W<I.inactives.length;W++){var X=I.inactives[W].locals;e.forEach(X,function(e,t){X.hasOwnProperty(t)&&-1!=t.indexOf("@")&&(u.locals[t]=e)})}if(e.forEach(I.enter,function(e,t){var n,a=K.path[t];"reactivate"===e?(n=P(a),N.push(n),Q.push(n),A.push(E(a)),O=a):"updateStateParams"===e?(n=y(a),N.push(n),O=a):"enter"===e&&N.push(k(a))}),e.forEach(I.exit,function(e,t){var n=j.path[t];"inactivate"===e?(Q.push(b(n)),B.push(n)):"exit"===e&&(Q.push(w(n)),B.push(n))}),A.length&&e.forEach(A,function(e){N.push(e)}),K===O){var Y=O.self.name+".",Z=s.getInactiveStates(),et=[];Z.forEach(function(e){0===e.self.name.indexOf(Y)&&et.push(e)}),et.sort(),et.reverse(),Q=Q.concat(x(et,function(e){return w(e)})),B=B.concat(et)}K.path=N,j.path=Q;var tt=function(e){return(e.surrogateType?e.surrogateType+":":"")+e.self.name};F&&r.debug("SurrogateFromPath: ",x(Q,tt)),F&&r.debug("SurrogateToPath:   ",x(N,tt))}}var nt=S.apply(n,arguments);return nt.then(function(e){return J(),F&&h(r,g[e.name],n),e.status="active",e},function(e){return J(),F&&"transition prevented"!==e.message&&"transition aborted"!==e.message&&"transition superseded"!==e.message&&(r.debug("transition failed",e),console.log(e.stack)),d.reject(e)})},n}])}])}(angular);